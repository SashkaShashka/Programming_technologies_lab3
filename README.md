# Технологии программирования ЛР3 Вариант 18
Выполнили студенты группы 6407 Одобеску Роман и Андреев Александр
### Задание к ЛР3
Добавьте в свой предыдущий проект возможность сохранения состояния в виде периодического сохранения, либо в виде функций импорта и экспорта. Выбранный формат для сериализации должен иметь схему. В проекте обязателен код валидирующий данные. Валидация должна производиться либо в программе при импорте данных, либо в юнит-тестах, проверяющих корректность сохранения состояния.
### Описание работы
В данной ЛР созданы два файла Server и Client. Сервер контроллирует взаимодействия двух клиентов (игроков) и ведет "общение" с ними посредством пересылки JSON файлов, а так же он отвечает за реализацию самой игры. Сначала запускается Server, далее он ожидает подключение игроков. После их подключения ожидает от них выбор действия (камень/ножницы/бумага). Далее он получает выбор игроков и отправляет результат игрокам об их выигрыше, проигрыше или ничье, а так же дублирует это у себя. После этого игра заканчивается.

В третьей лабораторной работе добавлена возможность сохранения состояния игры. Это помогает восстанавливать игру при падении сервера. Сохранения производятся в виде json файла server_state.json, его корректность проверяется с помощью 6 схем, каждая из которых соответствует определенной ситуации. Согласно концепции игры, написанной во 2 ЛР, клиенты характеризуются именем сокета, поэтому если клиент отключился, то подключиться заново он уже не сможет, так как ему будет присвоен другой номер сокета.
При начале новой игры на сервере файл server_state должен отсутствовать. При не соответствии файла ни одной из 6 схем на сервере появится сообщение о том, что сохранения повреждены и произойдет запуск новой игры.

Файл server_state хранит в себе информацию о клиентах: имя клиента (client0 или client1), его статус ("disconnected", "не принят ответ",("камень","нодницы","бумага")), адрес и сокет. На обоих сторонах реализован timeout подключения: (Client) если не удалось переподключиться к серверу в течение 10 секунд, клиент узнает об этом и игра для него завершается; (Server) при возобновлении работы сервера если не удается подключиться к клиенту в течение 5 секунд, он считается отключенным от сервера. Если оба клиента отключены от сервера, игра прекращается и в при следующем запуске начнется новая игра. Каждый запуск сервера рассчитан на 1 игру или на продолжение прошлой игры.

Работа была выполнена на языке Python.

Если сервер упал, но ни один из игроков еще подключился, то ожидаемо начинаем новую игру.

![image](https://user-images.githubusercontent.com/62326372/146580544-b68e1e25-2fa3-4981-b185-7b7d9da72a93.png)

Если один из игроков подключился, а сервер упап, то мы постараемся его подключить и завершить с ним игру.

![image](https://user-images.githubusercontent.com/62326372/146579817-6300889c-b1de-4f38-8ab4-df1963ef90f6.png)

Если возникла ситуация, что оба присоединились, но не отправили корректный ответ, то она снова подключатся и игра продолжится.

![image](https://user-images.githubusercontent.com/62326372/146575454-c9da8392-4314-4cb9-873c-92260ee0e631.png)

Если какой-то игрок ввел корректные данные, а второй нет, то игра также корректно продолжиться с сохранением состояния.

![image](https://user-images.githubusercontent.com/62326372/146577186-5dde9b77-5432-4927-807f-b318f44e2f52.png)

Если по каким-либо причинам файл server_state.json содержит некорректные данные, то мы сможем увидеть следующее сообщение:

![image](https://user-images.githubusercontent.com/62326372/146577861-664da045-b8ef-4eaa-8405-d7960189edcf.png)

Как пользователь видит неудачную попытку повторно присоединиться к серверу:

![image](https://user-images.githubusercontent.com/62326372/146578281-8b8471a8-90a3-4384-a237-d487d60748d7.png)

Как сервер оповестит о том, что к нему никто не проединился:

![image](https://user-images.githubusercontent.com/62326372/146578690-b534c50a-a26b-4a51-9dc8-6457dce1777a.png)
